<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta data-react-helmet="true" name="gatsby-theme" content="@lekoarts/gatsby-theme-minimal-blog"/><meta data-react-helmet="true" name="twitter:creator" content="@oisinbates"/><meta data-react-helmet="true" name="twitter:image:alt" content="I recently encountered a use-case that required the management of multiple long-running backend tasks while also necessitating granular…"/><meta data-react-helmet="true" name="twitter:image" content="https://oisinbates.com/banner.jpg"/><meta data-react-helmet="true" name="twitter:description" content="I recently encountered a use-case that required the management of multiple long-running backend tasks while also necessitating granular…"/><meta data-react-helmet="true" name="twitter:url" content="https://oisinbates.com/dynamic-filtering-with-vuejs-and-rmarkdown"/><meta data-react-helmet="true" name="twitter:title" content="Managing asynchronous backend tasks with Django and Celery"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" property="og:image:alt" content="I recently encountered a use-case that required the management of multiple long-running backend tasks while also necessitating granular…"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" property="og:image" content="https://oisinbates.com/banner.jpg"/><meta data-react-helmet="true" property="og:description" content="I recently encountered a use-case that required the management of multiple long-running backend tasks while also necessitating granular…"/><meta data-react-helmet="true" property="og:url" content="https://oisinbates.com/dynamic-filtering-with-vuejs-and-rmarkdown"/><meta data-react-helmet="true" property="og:title" content="Managing asynchronous backend tasks with Django and Celery"/><meta data-react-helmet="true" name="image" content="https://oisinbates.com/banner.jpg"/><meta data-react-helmet="true" name="description" content="I recently encountered a use-case that required the management of multiple long-running backend tasks while also necessitating granular…"/><meta name="generator" content="Gatsby 4.17.1"/><title data-react-helmet="true">Managing asynchronous backend tasks with Django and Celery | Oisín Bates</title><link data-react-helmet="true" rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link data-react-helmet="true" rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link data-react-helmet="true" rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/><link data-react-helmet="true" rel="canonical" href="https://oisinbates.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="true"/><link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&amp;display=swap"/><link rel="sitemap" type="application/xml" href="/sitemap/sitemap-index.xml"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="192x192" href="/android-chrome-192x192.png"/><link rel="apple-touch-icon" sizes="512x512" href="/android-chrome-512x512.png"/><link rel="alternate" type="application/rss+xml" title="Minimal Blog - @lekoarts/gatsby-theme-minimal-blog" href="/rss.xml"/></head><body><script>(function() { try {
  var mode = localStorage.getItem('theme-ui-color-mode');
  if (!mode) return
  document.documentElement.classList.add('theme-ui-' + mode);
} catch (e) {} })();</script><div id="___gatsby"><style data-emotion="css-global 1yc3m30">html{--theme-ui-colors-transparent:transparent;--theme-ui-colors-black:#000;--theme-ui-colors-white:#fff;--theme-ui-colors-gray-1:#f7fafc;--theme-ui-colors-gray-2:#edf2f7;--theme-ui-colors-gray-3:#e2e8f0;--theme-ui-colors-gray-4:#cbd5e0;--theme-ui-colors-gray-5:#a0aec0;--theme-ui-colors-gray-6:#718096;--theme-ui-colors-gray-7:#4a5568;--theme-ui-colors-gray-8:#2d3748;--theme-ui-colors-gray-9:#1a202c;--theme-ui-colors-red-1:#fff5f5;--theme-ui-colors-red-2:#fed7d7;--theme-ui-colors-red-3:#feb2b2;--theme-ui-colors-red-4:#fc8181;--theme-ui-colors-red-5:#f56565;--theme-ui-colors-red-6:#e53e3e;--theme-ui-colors-red-7:#c53030;--theme-ui-colors-red-8:#9b2c2c;--theme-ui-colors-red-9:#742a2a;--theme-ui-colors-orange-1:#fffaf0;--theme-ui-colors-orange-2:#feebc8;--theme-ui-colors-orange-3:#fbd38d;--theme-ui-colors-orange-4:#f6ad55;--theme-ui-colors-orange-5:#ed8936;--theme-ui-colors-orange-6:#dd6b20;--theme-ui-colors-orange-7:#c05621;--theme-ui-colors-orange-8:#9c4221;--theme-ui-colors-orange-9:#7b341e;--theme-ui-colors-yellow-1:#fffff0;--theme-ui-colors-yellow-2:#fefcbf;--theme-ui-colors-yellow-3:#faf089;--theme-ui-colors-yellow-4:#f6e05e;--theme-ui-colors-yellow-5:#ecc94b;--theme-ui-colors-yellow-6:#d69e2e;--theme-ui-colors-yellow-7:#b7791f;--theme-ui-colors-yellow-8:#975a16;--theme-ui-colors-yellow-9:#744210;--theme-ui-colors-green-1:#f0fff4;--theme-ui-colors-green-2:#c6f6d5;--theme-ui-colors-green-3:#9ae6b4;--theme-ui-colors-green-4:#68d391;--theme-ui-colors-green-5:#48bb78;--theme-ui-colors-green-6:#38a169;--theme-ui-colors-green-7:#2f855a;--theme-ui-colors-green-8:#276749;--theme-ui-colors-green-9:#22543d;--theme-ui-colors-teal-1:#e6fffa;--theme-ui-colors-teal-2:#b2f5ea;--theme-ui-colors-teal-3:#81e6d9;--theme-ui-colors-teal-4:#4fd1c5;--theme-ui-colors-teal-5:#38b2ac;--theme-ui-colors-teal-6:#319795;--theme-ui-colors-teal-7:#2c7a7b;--theme-ui-colors-teal-8:#285e61;--theme-ui-colors-teal-9:#234e52;--theme-ui-colors-blue-1:#ebf8ff;--theme-ui-colors-blue-2:#bee3f8;--theme-ui-colors-blue-3:#90cdf4;--theme-ui-colors-blue-4:#63b3ed;--theme-ui-colors-blue-5:#4299e1;--theme-ui-colors-blue-6:#3182ce;--theme-ui-colors-blue-7:#2b6cb0;--theme-ui-colors-blue-8:#2c5282;--theme-ui-colors-blue-9:#2a4365;--theme-ui-colors-indigo-1:#ebf4ff;--theme-ui-colors-indigo-2:#c3dafe;--theme-ui-colors-indigo-3:#a3bffa;--theme-ui-colors-indigo-4:#7f9cf5;--theme-ui-colors-indigo-5:#667eea;--theme-ui-colors-indigo-6:#5a67d8;--theme-ui-colors-indigo-7:#4c51bf;--theme-ui-colors-indigo-8:#434190;--theme-ui-colors-indigo-9:#3c366b;--theme-ui-colors-purple-1:#faf5ff;--theme-ui-colors-purple-2:#e9d8fd;--theme-ui-colors-purple-3:#d6bcfa;--theme-ui-colors-purple-4:#b794f4;--theme-ui-colors-purple-5:#9f7aea;--theme-ui-colors-purple-6:#805ad5;--theme-ui-colors-purple-7:#6b46c1;--theme-ui-colors-purple-8:#553c9a;--theme-ui-colors-purple-9:#44337a;--theme-ui-colors-pink-1:#fff5f7;--theme-ui-colors-pink-2:#fed7e2;--theme-ui-colors-pink-3:#fbb6ce;--theme-ui-colors-pink-4:#f687b3;--theme-ui-colors-pink-5:#ed64a6;--theme-ui-colors-pink-6:#d53f8c;--theme-ui-colors-pink-7:#b83280;--theme-ui-colors-pink-8:#97266d;--theme-ui-colors-pink-9:#702459;--theme-ui-colors-grayDark:#2d3748;--theme-ui-colors-text:#2d3748;--theme-ui-colors-background:#fff;--theme-ui-colors-primary:#6b46c1;--theme-ui-colors-primaryHover:#2c5282;--theme-ui-colors-secondary:#5f6c80;--theme-ui-colors-muted:#e2e8f0;--theme-ui-colors-success:#9ae6b4;--theme-ui-colors-info:#63b3ed;--theme-ui-colors-warning:#faf089;--theme-ui-colors-danger:#feb2b2;--theme-ui-colors-light:#f7fafc;--theme-ui-colors-dark:#2d3748;--theme-ui-colors-textMuted:#718096;--theme-ui-colors-toggleIcon:#2d3748;--theme-ui-colors-heading:#000;--theme-ui-colors-divide:#cbd5e0;color:var(--theme-ui-colors-text);background-color:var(--theme-ui-colors-background);}html.theme-ui-__default,.theme-ui-__default html{--theme-ui-colors-transparent:transparent;--theme-ui-colors-black:#000;--theme-ui-colors-white:#fff;--theme-ui-colors-gray-1:#f7fafc;--theme-ui-colors-gray-2:#edf2f7;--theme-ui-colors-gray-3:#e2e8f0;--theme-ui-colors-gray-4:#cbd5e0;--theme-ui-colors-gray-5:#a0aec0;--theme-ui-colors-gray-6:#718096;--theme-ui-colors-gray-7:#4a5568;--theme-ui-colors-gray-8:#2d3748;--theme-ui-colors-gray-9:#1a202c;--theme-ui-colors-red-1:#fff5f5;--theme-ui-colors-red-2:#fed7d7;--theme-ui-colors-red-3:#feb2b2;--theme-ui-colors-red-4:#fc8181;--theme-ui-colors-red-5:#f56565;--theme-ui-colors-red-6:#e53e3e;--theme-ui-colors-red-7:#c53030;--theme-ui-colors-red-8:#9b2c2c;--theme-ui-colors-red-9:#742a2a;--theme-ui-colors-orange-1:#fffaf0;--theme-ui-colors-orange-2:#feebc8;--theme-ui-colors-orange-3:#fbd38d;--theme-ui-colors-orange-4:#f6ad55;--theme-ui-colors-orange-5:#ed8936;--theme-ui-colors-orange-6:#dd6b20;--theme-ui-colors-orange-7:#c05621;--theme-ui-colors-orange-8:#9c4221;--theme-ui-colors-orange-9:#7b341e;--theme-ui-colors-yellow-1:#fffff0;--theme-ui-colors-yellow-2:#fefcbf;--theme-ui-colors-yellow-3:#faf089;--theme-ui-colors-yellow-4:#f6e05e;--theme-ui-colors-yellow-5:#ecc94b;--theme-ui-colors-yellow-6:#d69e2e;--theme-ui-colors-yellow-7:#b7791f;--theme-ui-colors-yellow-8:#975a16;--theme-ui-colors-yellow-9:#744210;--theme-ui-colors-green-1:#f0fff4;--theme-ui-colors-green-2:#c6f6d5;--theme-ui-colors-green-3:#9ae6b4;--theme-ui-colors-green-4:#68d391;--theme-ui-colors-green-5:#48bb78;--theme-ui-colors-green-6:#38a169;--theme-ui-colors-green-7:#2f855a;--theme-ui-colors-green-8:#276749;--theme-ui-colors-green-9:#22543d;--theme-ui-colors-teal-1:#e6fffa;--theme-ui-colors-teal-2:#b2f5ea;--theme-ui-colors-teal-3:#81e6d9;--theme-ui-colors-teal-4:#4fd1c5;--theme-ui-colors-teal-5:#38b2ac;--theme-ui-colors-teal-6:#319795;--theme-ui-colors-teal-7:#2c7a7b;--theme-ui-colors-teal-8:#285e61;--theme-ui-colors-teal-9:#234e52;--theme-ui-colors-blue-1:#ebf8ff;--theme-ui-colors-blue-2:#bee3f8;--theme-ui-colors-blue-3:#90cdf4;--theme-ui-colors-blue-4:#63b3ed;--theme-ui-colors-blue-5:#4299e1;--theme-ui-colors-blue-6:#3182ce;--theme-ui-colors-blue-7:#2b6cb0;--theme-ui-colors-blue-8:#2c5282;--theme-ui-colors-blue-9:#2a4365;--theme-ui-colors-indigo-1:#ebf4ff;--theme-ui-colors-indigo-2:#c3dafe;--theme-ui-colors-indigo-3:#a3bffa;--theme-ui-colors-indigo-4:#7f9cf5;--theme-ui-colors-indigo-5:#667eea;--theme-ui-colors-indigo-6:#5a67d8;--theme-ui-colors-indigo-7:#4c51bf;--theme-ui-colors-indigo-8:#434190;--theme-ui-colors-indigo-9:#3c366b;--theme-ui-colors-purple-1:#faf5ff;--theme-ui-colors-purple-2:#e9d8fd;--theme-ui-colors-purple-3:#d6bcfa;--theme-ui-colors-purple-4:#b794f4;--theme-ui-colors-purple-5:#9f7aea;--theme-ui-colors-purple-6:#805ad5;--theme-ui-colors-purple-7:#6b46c1;--theme-ui-colors-purple-8:#553c9a;--theme-ui-colors-purple-9:#44337a;--theme-ui-colors-pink-1:#fff5f7;--theme-ui-colors-pink-2:#fed7e2;--theme-ui-colors-pink-3:#fbb6ce;--theme-ui-colors-pink-4:#f687b3;--theme-ui-colors-pink-5:#ed64a6;--theme-ui-colors-pink-6:#d53f8c;--theme-ui-colors-pink-7:#b83280;--theme-ui-colors-pink-8:#97266d;--theme-ui-colors-pink-9:#702459;--theme-ui-colors-grayDark:#2d3748;--theme-ui-colors-text:#2d3748;--theme-ui-colors-background:#fff;--theme-ui-colors-primary:#6b46c1;--theme-ui-colors-primaryHover:#2c5282;--theme-ui-colors-secondary:#5f6c80;--theme-ui-colors-muted:#e2e8f0;--theme-ui-colors-success:#9ae6b4;--theme-ui-colors-info:#63b3ed;--theme-ui-colors-warning:#faf089;--theme-ui-colors-danger:#feb2b2;--theme-ui-colors-light:#f7fafc;--theme-ui-colors-dark:#2d3748;--theme-ui-colors-textMuted:#718096;--theme-ui-colors-toggleIcon:#2d3748;--theme-ui-colors-heading:#000;--theme-ui-colors-divide:#cbd5e0;}html.theme-ui-dark,.theme-ui-dark html{--theme-ui-colors-text:#cbd5e0;--theme-ui-colors-primary:#9f7aea;--theme-ui-colors-secondary:#7f8ea3;--theme-ui-colors-toggleIcon:#cbd5e0;--theme-ui-colors-background:#1A202C;--theme-ui-colors-heading:#fff;--theme-ui-colors-divide:#2d3748;--theme-ui-colors-muted:#2d3748;}</style><style data-emotion="css-global 1j0yc2g">*{box-sizing:border-box;}html{font-family:"IBM Plex Sans",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";line-height:1.625;font-weight:400;color:var(--theme-ui-colors-text);background-color:var(--theme-ui-colors-background);margin:0;padding:0;box-sizing:border-box;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;}body{margin:0;}</style><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion="css-global h7esfd">*{box-sizing:inherit;}html{-webkit-text-size-adjust:100%;}img{border-style:none;}pre{font-family:monospace;font-size:1em;}[hidden]{display:none;}::selection{background-color:var(--theme-ui-colors-text);color:var(--theme-ui-colors-background);}a{-webkit-transition:all 0.3s ease-in-out;transition:all 0.3s ease-in-out;color:text;}</style><style data-emotion="css 1gq7j3t">.css-1gq7j3t{border:0;clip:react(0 0 0 0);height:1px;width:1px;margin:-1px;padding:0;overflow:hidden;position:absolute;}.css-1gq7j3t:focus{padding:1rem;position:fixed;top:15px;left:15px;background-color:var(--theme-ui-colors-heading);color:var(--theme-ui-colors-background);z-index:1;width:auto;height:auto;clip:auto;-webkit-text-decoration:none;text-decoration:none;}</style><a href="#skip-nav" data-skip-link="true" class="css-1gq7j3t">Skip to content</a><style data-emotion="css 1jrqzhj">.css-1jrqzhj{box-sizing:border-box;margin:0;min-width:0;width:100%;max-width:container;margin-left:auto;margin-right:auto;padding:1rem;max-width:1024px;}@media screen and (min-width: 640px){.css-1jrqzhj{padding:2rem;}}</style><div class="css-1jrqzhj"><style data-emotion="css egutgn">.css-egutgn{margin-bottom:4rem;}@media screen and (min-width: 640px){.css-egutgn{margin-bottom:8rem;}}</style><header class="css-egutgn"><style data-emotion="css 1xwyizx">.css-1xwyizx{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;}</style><style data-emotion="css 10klvkd">.css-10klvkd{box-sizing:border-box;margin:0;min-width:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;}</style><div class="css-10klvkd"><style data-emotion="css uxjqfw">.css-uxjqfw{color:var(--theme-ui-colors-heading);-webkit-text-decoration:none;text-decoration:none;}</style><a aria-label="Oisín Bates - Back to home" class="css-uxjqfw" href="/"><style data-emotion="css 102q2va">.css-102q2va{margin-top:0;margin-bottom:0;font-weight:500;font-size:1.5rem;}@media screen and (min-width: 640px){.css-102q2va{font-size:1.875rem;}}</style><div class="css-102q2va">Oisín Bates</div></a><style data-emotion="css zut31r">.css-zut31r{opacity:0.65;position:relative;border-radius:5px;width:40px;height:25px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-transition:opacity 0.3s ease;transition:opacity 0.3s ease;border:none;outline:none;background:none;cursor:pointer;padding:0;-webkit-appearance:none;-moz-appearance:none;-ms-appearance:none;appearance:none;}.css-zut31r:hover,.css-zut31r:focus{opacity:1;}</style><button type="button" aria-label="Activate Dark Mode" title="Activate Dark Mode" class="css-zut31r"><style data-emotion="css 1m6u41m">.css-1m6u41m{position:relative;width:24px;height:24px;border-radius:50%;border:none;background-color:var(--theme-ui-colors-transparent);-webkit-transform:scale(1);-moz-transform:scale(1);-ms-transform:scale(1);transform:scale(1);-webkit-transition:all 0.45s ease;transition:all 0.45s ease;overflow:hidden;box-shadow:inset 8px -8px 0px 0px var(--theme-ui-colors-toggleIcon);}.css-1m6u41m:before{content:"";position:absolute;right:-9px;top:-9px;height:24px;width:24px;border:none;border-radius:50%;-webkit-transform:translate(0, 0);-moz-transform:translate(0, 0);-ms-transform:translate(0, 0);transform:translate(0, 0);opacity:1;-webkit-transition:-webkit-transform 0.45s ease;transition:transform 0.45s ease;}.css-1m6u41m:after{content:"";width:8px;height:8px;border-radius:50%;margin:-4px 0 0 -4px;position:absolute;top:50%;left:50%;box-shadow:0 -23px 0 var(--theme-ui-colors-toggleIcon),0 23px 0 var(--theme-ui-colors-toggleIcon),23px 0 0 var(--theme-ui-colors-toggleIcon),-23px 0 0 var(--theme-ui-colors-toggleIcon),15px 15px 0 var(--theme-ui-colors-toggleIcon),-15px 15px 0 var(--theme-ui-colors-toggleIcon),15px -15px 0 var(--theme-ui-colors-toggleIcon),-15px -15px 0 var(--theme-ui-colors-toggleIcon);-webkit-transform:scale(0);-moz-transform:scale(0);-ms-transform:scale(0);transform:scale(0);-webkit-transition:all 0.35s ease;transition:all 0.35s ease;}</style><div class="css-1m6u41m"></div></button></div><style data-emotion="css fp1v3n">.css-fp1v3n{box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;border-bottom-style:solid;border-bottom-width:1px;border-bottom-color:var(--theme-ui-colors-divide);padding-bottom:1rem;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;margin-top:1rem;color:var(--theme-ui-colors-secondary);-webkit-box-flex-flow:wrap;-webkit-flex-flow:wrap;-ms-flex-flow:wrap;flex-flow:wrap;}.css-fp1v3n a{color:var(--theme-ui-colors-secondary);}.css-fp1v3n a:hover{color:var(--theme-ui-colors-heading);}</style><div class="css-fp1v3n"><style data-emotion="css 1lx5s1f">.css-1lx5s1f{font-size:1rem;}.css-1lx5s1f a:not(:last-of-type){margin-right:1rem;}@media screen and (min-width: 640px){.css-1lx5s1f{font-size:18px;}}.css-1lx5s1f .active{color:var(--theme-ui-colors-heading);}</style><nav class="css-1lx5s1f"><style data-emotion="css bpdkdn">.css-bpdkdn{color:var(--theme-ui-colors-primary);-webkit-text-decoration:none;text-decoration:none;}.css-bpdkdn:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><a class="css-bpdkdn" href="/blog">Blog</a><a class="css-bpdkdn" href="/about">About</a></nav><style data-emotion="css 45ghvz">.css-45ghvz{font-size:1rem;}.css-45ghvz a:not(:first-of-type){margin-left:1rem;}@media screen and (min-width: 640px){.css-45ghvz{font-size:18px;}}</style><div class="css-45ghvz"><style data-emotion="css 1fmmdck">.css-1fmmdck{box-sizing:border-box;margin:0;min-width:0;color:var(--theme-ui-colors-primary);-webkit-text-decoration:none;text-decoration:none;}.css-1fmmdck:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><a href="https://github.com/oisinBates" class="css-1fmmdck">GitHub</a><a href="https://www.linkedin.com/in/oisinbates/" class="css-1fmmdck">Linkedin</a></div></div></header><style data-emotion="css 1c3blfx">.css-1c3blfx [data-name='live-editor']{font-size:1rem;}.css-1c3blfx [data-name='live-editor'] textarea,.css-1c3blfx [data-name='live-editor'] pre{padding:1rem!important;}.css-1c3blfx [data-name='live-preview']{padding:calc(0.5rem + 10px)!important;background-color:#d2c7ec;}.css-1c3blfx .prism-code{font-size:1rem;padding:2rem 1rem 1rem 1rem;webkit-overflow-scrolling:touch;background-color:var(--theme-ui-colors-transparent);min-width:100%;margin-bottom:0;margin-top:0;overflow:auto;}@media screen and (min-width: 640px){.css-1c3blfx .prism-code{font-size:1rem;}}@media screen and (min-width: 768px){.css-1c3blfx .prism-code{font-size:1.25rem;}}.css-1c3blfx .prism-code[data-linenumber="false"] .token-line{padding-left:1rem;}.css-1c3blfx .gatsby-highlight[data-language=''] .prism-code,.css-1c3blfx .gatsby-highlight[data-language='noLineNumbers'] .prism-code{padding-top:1rem;}.css-1c3blfx .token{display:inline-block;}.css-1c3blfx p>code,.css-1c3blfx li>code{background-color:var(--theme-ui-colors-gray-2);color:var(--theme-ui-colors-gray-8);padding-left:0.5rem;padding-right:0.5rem;padding-top:0.25rem;padding-bottom:0.25rem;border-radius:2px;}.css-1c3blfx .gatsby-highlight{font-size:1rem;position:relative;webkit-overflow-scrolling:touch;background-color:rgb(1, 22, 39);border-radius:2px;margin-left:0;margin-right:0;}@media screen and (min-width: 640px){.css-1c3blfx .gatsby-highlight{font-size:1rem;margin-left:0;margin-right:0;}}@media screen and (min-width: 768px){.css-1c3blfx .gatsby-highlight{font-size:1.25rem;margin-left:0;margin-right:0;}}@media screen and (min-width: 1024px){.css-1c3blfx .gatsby-highlight{margin-left:-1rem;margin-right:-1rem;}}.css-1c3blfx .gatsby-highlight .token-line{margin-left:-1rem;margin-right:-1rem;min-width:100%;}.css-1c3blfx .gatsby-highlight pre code{float:left;min-width:100%;}.css-1c3blfx .gatsby-highlight pre[class*="language-"]:before{background-color:var(--theme-ui-colors-white);border-radius:0 0 0.25rem 0.25rem;color:var(--theme-ui-colors-black);font-size:12px;letter-spacing:0.025rem;padding:0.1rem 0.5rem;position:absolute;left:1rem;text-align:right;text-transform:uppercase;top:0;}.css-1c3blfx .gatsby-highlight pre[class~="language-javascript"]:before,.css-1c3blfx .gatsby-highlight pre[class~="language-js"]:before{content:"js";background:#f7df1e;color:var(--theme-ui-colors-black);}.css-1c3blfx .gatsby-highlight pre[class~="language-jsx"]:before{content:"jsx";background:#61dafb;color:var(--theme-ui-colors-black);}.css-1c3blfx .gatsby-highlight pre[class~="language-ts"]:before{content:"ts";background:#61dafb;color:var(--theme-ui-colors-black);}.css-1c3blfx .gatsby-highlight pre[class~="language-tsx"]:before{content:"tsx";background:#61dafb;color:var(--theme-ui-colors-black);}.css-1c3blfx .gatsby-highlight pre[class~="language-html"]:before{content:"html";background:#005a9c;color:var(--theme-ui-colors-white);}.css-1c3blfx .gatsby-highlight pre[class~="language-xml"]:before{content:"xml";background:#005a9c;color:var(--theme-ui-colors-white);}.css-1c3blfx .gatsby-highlight pre[class~="language-svg"]:before{content:"svg";background:#005a9c;color:var(--theme-ui-colors-white);}.css-1c3blfx .gatsby-highlight pre[class~="language-graphql"]:before{content:"GraphQL";background:#E10098;}.css-1c3blfx .gatsby-highlight pre[class~="language-css"]:before{content:"css";background:#ff9800;color:var(--theme-ui-colors-black);}.css-1c3blfx .gatsby-highlight pre[class~="language-mdx"]:before{content:"mdx";background:#f9ac00;color:var(--theme-ui-colors-black);}.css-1c3blfx .gatsby-highlight pre[class~="language-php"]:before{content:"php";background:#777bb3;color:var(--theme-ui-colors-black);}.css-1c3blfx .gatsby-highlight pre[class~="language-py"]:before,.css-1c3blfx .gatsby-highlight pre[class~="language-python"]:before{content:"py";background:#306998;color:var(--theme-ui-colors-white);}.css-1c3blfx .gatsby-highlight pre[class~="language-text"]:before{content:"text";}.css-1c3blfx .gatsby-highlight pre[class~='language-shell']:before{content:'shell';}.css-1c3blfx .gatsby-highlight pre[class~='language-sh']:before{content:'sh';}.css-1c3blfx .gatsby-highlight pre[class~='language-bash']:before{content:'bash';}.css-1c3blfx .gatsby-highlight pre[class~='language-yaml']:before{content:'yaml';background:#ffa8df;}.css-1c3blfx .gatsby-highlight pre[class~='language-yml']:before{content:'yml';background:#ffa8df;}.css-1c3blfx .gatsby-highlight pre[class~='language-markdown']:before{content:'md';}.css-1c3blfx .gatsby-highlight pre[class~='language-json']:before,.css-1c3blfx .gatsby-highlight pre[class~='language-json5']:before{content:'json';background:linen;}.css-1c3blfx .gatsby-highlight pre[class~='language-diff']:before{content:'diff';background:#e6ffed;}.css-1c3blfx .gatsby-highlight>code[class*="language-"],.css-1c3blfx .gatsby-highlight>pre[class=*="language-"]{word-spacing:normal;word-break:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;}.css-1c3blfx .gatsby-highlight pre::-webkit-scrollbar{width:0.5rem;height:0.5rem;}.css-1c3blfx .gatsby-highlight pre::-webkit-scrollbar-thumb{background-color:var(--theme-ui-colors-primary);}.css-1c3blfx .gatsby-highlight pre::-webkit-scrollbar-track{background:rgb(1, 22, 39);}.css-1c3blfx .line-number-style{display:inline-block;width:3em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;opacity:0.3;text-align:center;position:relative;}.css-1c3blfx .code-title{background-color:#d2c7ec;color:var(--theme-ui-colors-black);font-size:0.875rem;padding-left:1rem;padding-right:1rem;padding-top:0.5rem;padding-bottom:0.5rem;font-family:Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;margin-left:0;margin-right:0;}@media screen and (min-width: 640px){.css-1c3blfx .code-title{margin-left:0;margin-right:0;}}@media screen and (min-width: 768px){.css-1c3blfx .code-title{margin-left:0;margin-right:0;}}@media screen and (min-width: 1024px){.css-1c3blfx .code-title{margin-left:-1rem;margin-right:-1rem;}}.css-1c3blfx [data-name='live-preview'],.css-1c3blfx [data-name='live-editor']{margin-left:0;margin-right:0;font-size:1rem;}@media screen and (min-width: 640px){.css-1c3blfx [data-name='live-preview'],.css-1c3blfx [data-name='live-editor']{margin-left:0;margin-right:0;font-size:1rem;}}@media screen and (min-width: 768px){.css-1c3blfx [data-name='live-preview'],.css-1c3blfx [data-name='live-editor']{margin-left:0;margin-right:0;font-size:1.25rem;}}@media screen and (min-width: 1024px){.css-1c3blfx [data-name='live-preview'],.css-1c3blfx [data-name='live-editor']{margin-left:-1rem;margin-right:-1rem;}}.css-1c3blfx .token-line{padding-right:1rem;}.css-1c3blfx .highlight-line{background-color:rgb(2, 55, 81);border-left:4px solid rgb(2, 155, 206);}.css-1c3blfx .highlight-line .line-number-style{width:calc(3em - 4px);opacity:0.5;left:-2px;}.css-1c3blfx .react-live-wrapper{position:relative;}.css-1c3blfx .react-live-wrapper .code-copy-button{right:0;}@media screen and (min-width: 640px){.css-1c3blfx .react-live-wrapper .code-copy-button{right:0;}}@media screen and (min-width: 768px){.css-1c3blfx .react-live-wrapper .code-copy-button{right:0;}}@media screen and (min-width: 1024px){.css-1c3blfx .react-live-wrapper .code-copy-button{right:-1rem;}}</style><style data-emotion="css albdeh">.css-albdeh{box-sizing:border-box;margin:0;min-width:0;}.css-albdeh [data-name='live-editor']{font-size:1rem;}.css-albdeh [data-name='live-editor'] textarea,.css-albdeh [data-name='live-editor'] pre{padding:1rem!important;}.css-albdeh [data-name='live-preview']{padding:calc(0.5rem + 10px)!important;background-color:#d2c7ec;}.css-albdeh .prism-code{font-size:1rem;padding:2rem 1rem 1rem 1rem;webkit-overflow-scrolling:touch;background-color:var(--theme-ui-colors-transparent);min-width:100%;margin-bottom:0;margin-top:0;overflow:auto;}@media screen and (min-width: 640px){.css-albdeh .prism-code{font-size:1rem;}}@media screen and (min-width: 768px){.css-albdeh .prism-code{font-size:1.25rem;}}.css-albdeh .prism-code[data-linenumber="false"] .token-line{padding-left:1rem;}.css-albdeh .gatsby-highlight[data-language=''] .prism-code,.css-albdeh .gatsby-highlight[data-language='noLineNumbers'] .prism-code{padding-top:1rem;}.css-albdeh .token{display:inline-block;}.css-albdeh p>code,.css-albdeh li>code{background-color:var(--theme-ui-colors-gray-2);color:var(--theme-ui-colors-gray-8);padding-left:0.5rem;padding-right:0.5rem;padding-top:0.25rem;padding-bottom:0.25rem;border-radius:2px;}.css-albdeh .gatsby-highlight{font-size:1rem;position:relative;webkit-overflow-scrolling:touch;background-color:rgb(1, 22, 39);border-radius:2px;margin-left:0;margin-right:0;}@media screen and (min-width: 640px){.css-albdeh .gatsby-highlight{font-size:1rem;margin-left:0;margin-right:0;}}@media screen and (min-width: 768px){.css-albdeh .gatsby-highlight{font-size:1.25rem;margin-left:0;margin-right:0;}}@media screen and (min-width: 1024px){.css-albdeh .gatsby-highlight{margin-left:-1rem;margin-right:-1rem;}}.css-albdeh .gatsby-highlight .token-line{margin-left:-1rem;margin-right:-1rem;min-width:100%;}.css-albdeh .gatsby-highlight pre code{float:left;min-width:100%;}.css-albdeh .gatsby-highlight pre[class*="language-"]:before{background-color:var(--theme-ui-colors-white);border-radius:0 0 0.25rem 0.25rem;color:var(--theme-ui-colors-black);font-size:12px;letter-spacing:0.025rem;padding:0.1rem 0.5rem;position:absolute;left:1rem;text-align:right;text-transform:uppercase;top:0;}.css-albdeh .gatsby-highlight pre[class~="language-javascript"]:before,.css-albdeh .gatsby-highlight pre[class~="language-js"]:before{content:"js";background:#f7df1e;color:var(--theme-ui-colors-black);}.css-albdeh .gatsby-highlight pre[class~="language-jsx"]:before{content:"jsx";background:#61dafb;color:var(--theme-ui-colors-black);}.css-albdeh .gatsby-highlight pre[class~="language-ts"]:before{content:"ts";background:#61dafb;color:var(--theme-ui-colors-black);}.css-albdeh .gatsby-highlight pre[class~="language-tsx"]:before{content:"tsx";background:#61dafb;color:var(--theme-ui-colors-black);}.css-albdeh .gatsby-highlight pre[class~="language-html"]:before{content:"html";background:#005a9c;color:var(--theme-ui-colors-white);}.css-albdeh .gatsby-highlight pre[class~="language-xml"]:before{content:"xml";background:#005a9c;color:var(--theme-ui-colors-white);}.css-albdeh .gatsby-highlight pre[class~="language-svg"]:before{content:"svg";background:#005a9c;color:var(--theme-ui-colors-white);}.css-albdeh .gatsby-highlight pre[class~="language-graphql"]:before{content:"GraphQL";background:#E10098;}.css-albdeh .gatsby-highlight pre[class~="language-css"]:before{content:"css";background:#ff9800;color:var(--theme-ui-colors-black);}.css-albdeh .gatsby-highlight pre[class~="language-mdx"]:before{content:"mdx";background:#f9ac00;color:var(--theme-ui-colors-black);}.css-albdeh .gatsby-highlight pre[class~="language-php"]:before{content:"php";background:#777bb3;color:var(--theme-ui-colors-black);}.css-albdeh .gatsby-highlight pre[class~="language-py"]:before,.css-albdeh .gatsby-highlight pre[class~="language-python"]:before{content:"py";background:#306998;color:var(--theme-ui-colors-white);}.css-albdeh .gatsby-highlight pre[class~="language-text"]:before{content:"text";}.css-albdeh .gatsby-highlight pre[class~='language-shell']:before{content:'shell';}.css-albdeh .gatsby-highlight pre[class~='language-sh']:before{content:'sh';}.css-albdeh .gatsby-highlight pre[class~='language-bash']:before{content:'bash';}.css-albdeh .gatsby-highlight pre[class~='language-yaml']:before{content:'yaml';background:#ffa8df;}.css-albdeh .gatsby-highlight pre[class~='language-yml']:before{content:'yml';background:#ffa8df;}.css-albdeh .gatsby-highlight pre[class~='language-markdown']:before{content:'md';}.css-albdeh .gatsby-highlight pre[class~='language-json']:before,.css-albdeh .gatsby-highlight pre[class~='language-json5']:before{content:'json';background:linen;}.css-albdeh .gatsby-highlight pre[class~='language-diff']:before{content:'diff';background:#e6ffed;}.css-albdeh .gatsby-highlight>code[class*="language-"],.css-albdeh .gatsby-highlight>pre[class=*="language-"]{word-spacing:normal;word-break:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;}.css-albdeh .gatsby-highlight pre::-webkit-scrollbar{width:0.5rem;height:0.5rem;}.css-albdeh .gatsby-highlight pre::-webkit-scrollbar-thumb{background-color:var(--theme-ui-colors-primary);}.css-albdeh .gatsby-highlight pre::-webkit-scrollbar-track{background:rgb(1, 22, 39);}.css-albdeh .line-number-style{display:inline-block;width:3em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;opacity:0.3;text-align:center;position:relative;}.css-albdeh .code-title{background-color:#d2c7ec;color:var(--theme-ui-colors-black);font-size:0.875rem;padding-left:1rem;padding-right:1rem;padding-top:0.5rem;padding-bottom:0.5rem;font-family:Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;margin-left:0;margin-right:0;}@media screen and (min-width: 640px){.css-albdeh .code-title{margin-left:0;margin-right:0;}}@media screen and (min-width: 768px){.css-albdeh .code-title{margin-left:0;margin-right:0;}}@media screen and (min-width: 1024px){.css-albdeh .code-title{margin-left:-1rem;margin-right:-1rem;}}.css-albdeh [data-name='live-preview'],.css-albdeh [data-name='live-editor']{margin-left:0;margin-right:0;font-size:1rem;}@media screen and (min-width: 640px){.css-albdeh [data-name='live-preview'],.css-albdeh [data-name='live-editor']{margin-left:0;margin-right:0;font-size:1rem;}}@media screen and (min-width: 768px){.css-albdeh [data-name='live-preview'],.css-albdeh [data-name='live-editor']{margin-left:0;margin-right:0;font-size:1.25rem;}}@media screen and (min-width: 1024px){.css-albdeh [data-name='live-preview'],.css-albdeh [data-name='live-editor']{margin-left:-1rem;margin-right:-1rem;}}.css-albdeh .token-line{padding-right:1rem;}.css-albdeh .highlight-line{background-color:rgb(2, 55, 81);border-left:4px solid rgb(2, 155, 206);}.css-albdeh .highlight-line .line-number-style{width:calc(3em - 4px);opacity:0.5;left:-2px;}.css-albdeh .react-live-wrapper{position:relative;}.css-albdeh .react-live-wrapper .code-copy-button{right:0;}@media screen and (min-width: 640px){.css-albdeh .react-live-wrapper .code-copy-button{right:0;}}@media screen and (min-width: 768px){.css-albdeh .react-live-wrapper .code-copy-button{right:0;}}@media screen and (min-width: 1024px){.css-albdeh .react-live-wrapper .code-copy-button{right:-1rem;}}</style><main id="skip-nav" class=" css-albdeh"><style data-emotion="css 1aue9xx">.css-1aue9xx{box-sizing:border-box;margin:0;min-width:0;font-family:inherit;font-weight:700;line-height:1.25;font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:2.25rem;margin-top:2rem;color:var(--theme-ui-colors-heading);}@media screen and (min-width: 640px){.css-1aue9xx{font-size:3rem;}}@media screen and (min-width: 768px){.css-1aue9xx{font-size:3rem;}}@media screen and (min-width: 1024px){.css-1aue9xx{font-size:4rem;}}</style><h1 class="css-1aue9xx">Managing asynchronous backend tasks with Django and Celery</h1><style data-emotion="css 15ce8we">.css-15ce8we{color:var(--theme-ui-colors-secondary);margin-top:1rem;font-size:1rem;}.css-15ce8we a{color:var(--theme-ui-colors-secondary);}@media screen and (min-width: 640px){.css-15ce8we{font-size:1rem;}}@media screen and (min-width: 768px){.css-15ce8we{font-size:1.25rem;}}</style><p class="css-15ce8we"><time>08.07.2020</time> — <a class="css-bpdkdn" href="/tags/python">Python</a>, <a class="css-bpdkdn" href="/tags/django">Django</a> — <span>7<!-- --> min read</span></p><style data-emotion="css b56ay0">.css-b56ay0{margin-top:4rem;margin-bottom:4rem;}.css-b56ay0 .gatsby-resp-image-wrapper{margin-top:2rem;margin-bottom:2rem;box-shadow:rgba(0, 0, 0, 0.15) 0px 32px 32px 0px,rgba(0, 0, 0, 0.15) 0px 16px 16px 0px,rgba(0, 0, 0, 0.15) 0px 8px 8px 0px,rgba(0, 0, 0, 0.15) 0px 4px 4px 0px;}@media screen and (min-width: 640px){.css-b56ay0 .gatsby-resp-image-wrapper{margin-top:2rem;margin-bottom:2rem;}}@media screen and (min-width: 768px){.css-b56ay0 .gatsby-resp-image-wrapper{margin-top:4rem;margin-bottom:4rem;}}</style><section class="css-b56ay0"><style data-emotion="css 1ccrm8j">.css-1ccrm8j{font-size:1rem;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;word-break:break-word;}@media screen and (min-width: 640px){.css-1ccrm8j{font-size:1rem;}}@media screen and (min-width: 768px){.css-1ccrm8j{font-size:1.25rem;}}</style><p class="css-1ccrm8j">I recently encountered a use-case that required the management of multiple long-running backend tasks while also necessitating granular updates on the state and progress of each task. The feature was to be integrated into an existing Django codebase and our team desired a UI with multiple progress bars. Ultimately, I couldn’t find a tutorial covering quite what I was looking for, so my purpose here is to create the type of code demo and tutorial that I would have wanted for my specific needs, when beginning this journey. One popular tool for Python developers is <style data-emotion="css 1bw77fa">.css-1bw77fa{color:var(--theme-ui-colors-primary);-webkit-text-decoration:none;text-decoration:none;}.css-1bw77fa:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><a href="http://www.celeryproject.org/" class="css-1bw77fa">Celery</a>, a ‘task queue’ which facilitates the queuing and concurrent execution of multiple tasks (i.e. any manner of Python function you may need to run). <a href="https://github.com/czue/celery-progress" class="css-1bw77fa">Celery-Progress</a>, is a great Python package for — you guessed it — easily provisioning progress bars to monitor Celery tasks.</p><p class="css-1ccrm8j">So, what will this app cover? At a high level, the creation of a Django app which concurrently runs eight backend processes and provides state updates via progress bars and related metadata. In terms of showcasing Celery, I opted to go with something visually stimulating and poll the <a href="https://api.nasa.gov/" class="css-1bw77fa">NASA Astronomy Image of the Day API</a> forty times. Querying an API once is of course a short task on its own, but the logic outlined in this demo could be applied to any long-running task. If you’d rather jump straight into the finished codebase, you can clone a working example directly from <a href="https://github.com/oisinBates/celery_progress_demo" class="css-1bw77fa">GitHub</a>. Below is an example of the project we will be building, and you can check out a screen-recording of the app in progress <a href="https://www.youtube.com/watch?v=dWAJru1xx34" class="css-1bw77fa">here</a>.</p><p class="css-1ccrm8j"><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px">
      <span class="gatsby-resp-image-background-image" style="padding-bottom:57.08333333333333%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC/0lEQVQoz22RfUzUdRzHv7W1WSsMJ/OBlrPZmEOnWZl3txzEaPpTlg+pKMednD/owYYQVqO7m0IXO+WOLjw8HPnA1I2dVzOaN7AkXQt82MLaiqYCMuFywh3m/X63u4Pj1fix+Vef7b33+/Pa+6/PR7jcHho8jbgaPByo+ULzI03NOL50crjezVeeRlqOn+TTaitG8x6KjCY2bd5K5cf7+eZsG4eaW/CeaqXGUcfRo80IWZYxm814vV58Ph+dnR2Yik3MnZtBdvZy5qTPYbfZxLr1Ek889QzPp80m7bk0SiwWzrWe5M1iIwXOOlYZd2KvOYgw6HUIIcjMXIhBr6epyYskSRpb/FKW5tO7waDX8pNCMEsI3pYkjtmt5OhW87JcyqtVFdgbPYgDNXUUFctY5A94d9su3A1fU1JiYcGChSzNyuLFFzKRLRZqHU42bdlOkdGMaWcxrno3bafPkFNaxg6Xi9WFhVhtdkRvaIqf+ye5MZIiCaSAX/4O4+8ZJtgbYnhsnIdqjN9GUly6M8H1exP8m5rpXfzzAS2X+2nrGaK7t4+BkQeIPwZHab86QPD6IBeuDfLXUJiu7m6O+wP424Oc8H9LV3cPo4+i3B0dY2gswr3wOGFFJQ4o05pCy5OAuHLzPp5AH6c6+6lvvcqvN26Tm5vD8oxn+dyoZ9mieeh0Bv5vvj8X4JinkeYjPnweL4E2PyLw3XmqbVYchw9RXlnBD+3nkaT1rF2UzofvrCT3tRWs0Rmw26zk5+dRsa+cjRs3YLXZKJC2kP50Bq8vXsWS+SvJe6sAEez4iYO1dTicLqqtdoLBDqo+s5K7Np+9u0vJz9vAvopK5LK9ZGW/wrZCM2+s0fNJVRX22ga27nqfPXI575V9hNPpRly7q9LR94jLdxSGlUkeJlLcDCW4eEvl0u0oITWFOgW//5Okqz+u9UaTMzfrDSX48ZbClQGVyMQUsekbqokEEUVhXFG0b8aSEyjxOJFoVGPjagw1kdRY+DFTH7NIVJmREkOJJ/kPahJfoQ1FvgIAAAAASUVORK5CYII=&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image css-0" alt="Webapp Screenshot" title="Webapp Screenshot" src="/static/9f55882e1d858c3f9c5b9cacd5aadf59/7d769/webapp_screenshot.png" srcSet="/static/9f55882e1d858c3f9c5b9cacd5aadf59/5243c/webapp_screenshot.png 240w,/static/9f55882e1d858c3f9c5b9cacd5aadf59/ab158/webapp_screenshot.png 480w,/static/9f55882e1d858c3f9c5b9cacd5aadf59/7d769/webapp_screenshot.png 960w,/static/9f55882e1d858c3f9c5b9cacd5aadf59/87339/webapp_screenshot.png 1440w,/static/9f55882e1d858c3f9c5b9cacd5aadf59/88b03/webapp_screenshot.png 1920w,/static/9f55882e1d858c3f9c5b9cacd5aadf59/c71fc/webapp_screenshot.png 2880w" sizes="(max-width: 960px) 100vw, 960px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
    </span></p><p class="css-1ccrm8j">For those wishing to jump to a specific topic, the topics are structured in the following order:</p><style data-emotion="css 15rlv7r">.css-15rlv7r li{font-size:1rem;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width: 640px){.css-15rlv7r li{font-size:1rem;}}@media screen and (min-width: 768px){.css-15rlv7r li{font-size:1.25rem;}}</style><ul class="css-15rlv7r"><li class="css-0"><a href="#web-application-architecture" class="css-1bw77fa">Web Application Architecture</a></li><li class="css-0"><a href="#initial-django-configuration" class="css-1bw77fa">Initial Django Configuration</a></li><li class="css-0"><a href="#configuring-celery" class="css-1bw77fa">Configuring Celery and Celery-Progress</a></li><li class="css-0"><a href="#frontend-logic-and-templates" class="css-1bw77fa">Frontend Logic and Templates</a></li><li class="css-0"><a href="#running-final-app" class="css-1bw77fa">Running the final app and general parting thoughts</a></li></ul><style data-emotion="css 1o6lusp">.css-1o6lusp{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.5rem;margin-top:2rem;color:var(--theme-ui-colors-heading);}@media screen and (min-width: 640px){.css-1o6lusp{font-size:1.875rem;}}@media screen and (min-width: 768px){.css-1o6lusp{font-size:1.875rem;}}@media screen and (min-width: 1024px){.css-1o6lusp{font-size:2.25rem;}}</style><h3 id="web-application-architecture" class="css-1o6lusp">Web Application Architecture</h3><p class="css-1ccrm8j">This web app is built with the Django framework. It uses a NASA API to retrieve random images and image metadata. The processes of concurrently/repeatedly polling this API is managed by a task queue (Celery) which queues tasks via a message broker (RabbitMQ) and writes the state of each task to a database cache (Redis). The visualization of the tasks is managed by a Python package named celery-progress. This package, though written in Python, uses JavaScript on the frontend to poll our Redis cache for the current state of our Celery tasks.</p><p class="css-1ccrm8j">Here is a high-level overview of the architecture we’ll be implementing:</p><p class="css-1ccrm8j"><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:327px">
      <span class="gatsby-resp-image-background-image" style="padding-bottom:172.08333333333334%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAiCAYAAABfqvm9AAAACXBIWXMAAAsTAAALEwEAmpwYAAAHUElEQVRIx6WVe1DU1xXHf22npsakiW2TNp0009TUpDGttjqtTqPNJBNrrXUwQWMVFBQSXqKAyEvEKkZbeYgiKoKgoqIiD0FUQBZ5Kq7I8pKHyysKC7q77C67LAvsp/P77YKSdPJPz87Ze++5535/536/Z/cnqB73szHUz+YhW1jj74nTVi9cgnxx3x4wsece5i+NG0K24BbmL7kU3x6Aa/BmNkdux2gyIbS0P0CY8QrC9O/wwuw3Cd6/G/dQP3714R8RpgoIP5tq85cEhJ8+h/DGS1Ku8KPvIrw21Ta+LPDy3F+j1Q0gKLs7mTb7TWYtXcS53ExqGhUE7AnnH5874Rmxjb+7rWHByqVEJsSy2GUVL86ZgXdEEIH7/sU8h48JiYpkhZcLry+cg86gR2hWtkmLcvktopMSyCsukID994STnpfFzduVFJbKyCrI54qsgEtXc0k6n0a1ooaSqnIS0lKQVZWzcpMbPX0qhKYHrcz46E/UNjUQErWH0upKki+kkXvjugSWLyuk+p6ctf5eXMy/THt3J5HxMaTnZlJUcZPIwzEUlMlwDvThoarXduXnf/dLlmxYTfLFs/hFhlNdWyNda+fB/XiEB+IWvIWF/1yOU4AXi11Wcj4vG5H7eZ8s5ujZVCnnjb/8gQHxyi0dSoQZP0H4+TSEFwVmfjyfoP/sQnjteYRXpthF+QHCL36I8OPv4RbiJ1XnFRGE8OpzCK9OkYSZPm+mTZRHfSocN21kietnLHH5jBXerny03lEaxfinPhsk/8R7g0S+2CKbdofyN7c1OHiux8FjPQ5eLrgE+zJoMiLwjI1aRvh/TQLs6+ujtbWVpqYmVH19jI2NYRkZYeR/+OjoqORj1jF6VSpqFQrMw8NSzGq12gANBgM9PT10dXVJc9HETdHH5+JDRB+fi6bT6VAqlRNrCdBqX4yNjmIymmwb9th40rfZ0NDQpLwJDs2WYQbNZtumLWMiSay+pqaGhoYG6uvrUSgUtHd2MWQ280DZPlGEmC2Mmc0Y6upRRsVSuzWIvmIZjIxIm+OAFosFuVzO1atXKSospLCkjP60bVhvnUGXHjSpCKHxwCEK/vwBjZsDyH13NknC92lJTLKVbeds3CRRLMNIvZC6Hs56Q9xirJ1yMNu4F+QRu0gQBC689Rsy3n6PZGEK9yL32iqzUzDJrHYB0jywugpYw96C3XOw3oizAXbkXSF91hxSp00n9YXpnJ45i/r0C7R1dlJWWkp/f79EvNgWNrxRGx2Jq2GpAEGvY90zD7LDnopiMRq5m5jE3ePJPOzo4F5dHeXl5RQUFEij2J9Go3ES+dTlYc0Kw5wRChlbsXZU20Wxt4govvaZK3Z3d1NXV4darf5GX2IfxZOGcSbsdEgV9vb00Ci2w71aHj169A3axp4R5ymwlZ6vupDfvsWI2SSBiWFhvPP1er1UjajkeEz6idnBvu7j7SRy/Gx8orGHLWb0Bv3TKsSP+FTpYraKpLUUs9rbSATsm/znMDhowKAfRKcdRKvWYTZaMOiNGA1mzCYLQ0YLgwYTg3qTNBdjg4YhTINDDGgMtNxvY3holIEBnSScoFFrqW2uoqo5G9ndi5Q3ZNPYfofq1nxKai5yU5GB4kEF95QyaS6rucDd1mLqlBVUNGVRUpNB1f1cHnS0oH6iQdBrjVyXp7Dz9HJ2JTty6IoLRfWpHMx1I/TIMg5kO5FVHcO58p0EHVnC/vOrOVu+k5w7sYSnLCcydSXHijxQtFai1egQBnVmMkvj+WLfAk4VuhOT40hmRRyBh5cRlb6S5BtOJF/fTmyGF0GHF3OmzJWEPF9OXN/OpqgPOFPiTnTOKu403ESnNSCY9MOk5O9jRcg7rNj0e5y/nEtK4R7coxaxzHMWq8NnE33Jl52nnVnq/TafBv6WHSfXEpO5GYfAWazwnY1bzAJu1RXbAHVaPVV1xVyuPkb+nRNkVh6hrv02V+6kkC8/QUZFPNUtxZTUZZFbnUhW5RFkiiyqm2+Qc/soedXJ5Nw+Tnt3Gxq1BkFUqur+ZVJlgcSme5NeGcHdznyy5HuJPudBalEQZa3pyJpPEJfhydHLWyhqTKKi7TzHr/kTd8GH7Jq9tHYp0KgHEAwDQ+SUJ+AT8z4nCz/nYN5qcm7FE3bcgejzq0iRredkUQTx2b6EHv0rZ8s2knjNj1NFEfjFfciZEvHMWuSNpYi3FUx6C6cL/o1j6Dt4RC7E+9B8Tsm+5IvohTiHzMUnbj4Hsn3ZleaEY8C7+EQvIPKcM3E5m1kV/B5ee99ny7FF3G4oRj8wiCB+XSw8QcgxJ7bFuhBydB1ZN1OJPOVJ8EFXgg47c6YwnsS8SEIOr2PrgbXEX9rBqWsHCD7iRGDsOnYkb0ReX4XY04Jao0bV24f6sRatRov6sYYn/Wpp/fCrhyjb2uls76K5qYV2ZQe9PSp7joYnjzX2M1p6e1VotdrJL/qvm0qloqGxgc7ODu7fb6KpqRGNRvOtL/r/AjuOb9vvJpWgAAAAAElFTkSuQmCC&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image css-0" alt="Architecture Diagram" title="Architecture Diagram" src="/static/88cb07f71661a701341df3aa977136bc/d7b56/architecture_diagram.png" srcSet="/static/88cb07f71661a701341df3aa977136bc/5243c/architecture_diagram.png 240w,/static/88cb07f71661a701341df3aa977136bc/d7b56/architecture_diagram.png 327w" sizes="(max-width: 327px) 100vw, 327px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
    </span></p><h3 id="initial-django-configuration" class="css-1o6lusp">Initial Django Configuration</h3><p class="css-1ccrm8j">The following commands will create a Python <a href="https://docs.python.org/3/library/venv.html" class="css-1bw77fa">virtual environment</a> with all the necessary packages, before creating a new Django project and app, and starting a webserver to host the project.</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><style data-emotion="css dybovu">.css-dybovu{background-color:rgba(107,70,193,0.2);border:none;color:var(--theme-ui-colors-gray-2);cursor:pointer;font-size:14px;font-family:"IBM Plex Sans",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";letter-spacing:0.025rem;-webkit-transition:default;transition:default;position:absolute;top:0;right:0;z-index:1;border-radius:0 0 0 0.25rem;padding:0.25rem 0.6rem;}@media screen and (min-width: 640px){.css-dybovu{font-size:14px;}}@media screen and (min-width: 768px){.css-dybovu{font-size:16px;}}.css-dybovu[disabled]{cursor:not-allowed;}.css-dybovu:not([disabled]):hover{background-color:var(--theme-ui-colors-primary);color:var(--theme-ui-colors-white);}</style><button type="button" name="copy code to clipboard" class="code-copy-button css-dybovu">Copy<style data-emotion="css 15vf505">.css-15vf505{border:0;clip:rect(0, 0, 0, 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;white-space:nowrap;width:1px;}</style><span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic"># Create a new virtual environment and folder for this demo</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">mkdir</span><span class="token plain"> celery_demo </span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 139)">cd</span><span class="token plain"> celery_demo </span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain">python3 -m venv myvenv </span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 139)">source</span><span class="token plain"> myvenv/bin/activate </span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic"># install the necessary requirements via pip</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">python3 -m pip </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> --upgrade pip </span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 139)">printf</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;celery==4.4.2</span><span class="token string entity" style="color:rgb(173, 219, 103)">\n</span><span class="token string" style="color:rgb(173, 219, 103)">celery-progress==0.0.10</span><span class="token string entity" style="color:rgb(173, 219, 103)">\n</span><span class="token string" style="color:rgb(173, 219, 103)">Django==3.0.6</span><span class="token string entity" style="color:rgb(173, 219, 103)">\n</span><span class="token string" style="color:rgb(173, 219, 103)">nasapy==0.2.6</span><span class="token string entity" style="color:rgb(173, 219, 103)">\n</span><span class="token string" style="color:rgb(173, 219, 103)">pandas==1.0.3</span><span class="token string entity" style="color:rgb(173, 219, 103)">\n</span><span class="token string" style="color:rgb(173, 219, 103)">python-decouple==3.3</span><span class="token string entity" style="color:rgb(173, 219, 103)">\n</span><span class="token string" style="color:rgb(173, 219, 103)">requests==2.23.0&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;&gt;</span><span class="token plain"> requirements.txt </span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain">python3 -m pip </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> -r requirements.txt </span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic"># Create a new Django project and app </span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain">django-admin startproject demo_project </span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 139)">cd</span><span class="token plain"> demo_project/ </span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15</span><span class="token plain">python3 manage.py startapp demo_app </span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">16</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">17</span><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic"># Serve the new Django app</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">18</span><span class="token plain">python3 manage.py runserver</span></div></code></pre></div><p class="css-1ccrm8j">Once you have run the above commands, navigate to <a href="http://127.0.0.1:8000/" class="css-1bw77fa">http://127.0.0.1:8000/</a> in your web browser and you should see the following:</p><p class="css-1ccrm8j"><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px">
      <span class="gatsby-resp-image-background-image" style="padding-bottom:62.5%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA7klEQVQoz6WRXU7DMAyAe/+LwFQxaNciRq+A4IUTIETVSSMlcRKnjmPUVojxwE/LJyvxQz7HsrOX7tgbf//weHa+3eRFWe3L6rasm13dVHVTXTf1FHOyvayvyptit9/kRX5RZSJJRDARcJCFZPMVmQei+D1EkaYznrzK5B/8JB/REvMamTndHZ4sDctkRAQA1WurQak3bYx3LqX0V/kw0rVt+9yNAQAL2k4TMcY5WTOwz1qS1su//JxScgENOoMu8ogN3qDzFCQJDsGgt+j56+ayj8WwdvBqtAIdmWOMPWhltA0oIsZZBboHQ0Sn8jvQavKwHGbiZAAAAABJRU5ErkJggg==&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image css-0" alt="Django Installation Confirmation" title="Django Installation Confirmation" src="/static/b244be96288df4b62608758d5fbfdc8f/7d769/django_installation_confirmation.png" srcSet="/static/b244be96288df4b62608758d5fbfdc8f/5243c/django_installation_confirmation.png 240w,/static/b244be96288df4b62608758d5fbfdc8f/ab158/django_installation_confirmation.png 480w,/static/b244be96288df4b62608758d5fbfdc8f/7d769/django_installation_confirmation.png 960w,/static/b244be96288df4b62608758d5fbfdc8f/4af54/django_installation_confirmation.png 1400w" sizes="(max-width: 960px) 100vw, 960px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
    </span></p><h3 id="configuring-celery" class="css-1o6lusp">Configuring Celery and Celery-Progress</h3><p class="css-1ccrm8j">Having provisioned a new Django project, we can now begin adding our desired functionality. First off, let’s configure celery and celery progress. Create a new file called celery.py within our Django project (ie. <code class="css-0">celery_demo/demo_project/demo_project/celery.py</code>).</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-dybovu">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">from __future__ </span><span class="token function" style="color:rgb(130, 170, 255)">import</span><span class="token plain"> absolute_import, unicode_literals</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">from celery </span><span class="token function" style="color:rgb(130, 170, 255)">import</span><span class="token plain"> Celery</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">from decouple </span><span class="token function" style="color:rgb(130, 170, 255)">import</span><span class="token plain"> config</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">import</span><span class="token plain"> django</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">import</span><span class="token plain"> os</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">os.environ.setdefault</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;DJANGO_SETTINGS_MODULE&#x27;</span><span class="token plain">, </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;demo_project.settings&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">app </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> Celery</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;demo_project&#x27;</span><span class="token plain">, </span><span class="token assign-left variable" style="color:rgb(214, 222, 235)">backend</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;redis://localhost&#x27;</span><span class="token plain">, </span><span class="token assign-left variable" style="color:rgb(214, 222, 235)">broker</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;pyamqp://&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic"># Using a string here means the worker doesn&#x27;t have to serialize</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic"># the configuration object to child processes.</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic"># - namespace=&#x27;CELERY&#x27; means all celery-related configuration keys</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">#   should have a `CELERY_` prefix.</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15</span><span class="token plain">app.config_from_object</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;django.conf:settings&#x27;</span><span class="token plain">, </span><span class="token assign-left variable" style="color:rgb(214, 222, 235)">namespace</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;CELERY&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">16</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">17</span><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic"># Load task modules from all registered Django app configs.</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">18</span><span class="token plain">app.autodiscover_tasks</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">19</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">20</span><span class="token plain">@app.task</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">bind</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">True</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">21</span><span class="token plain">def debug_task</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">:</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">22</span><span class="token plain">    print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;Request: {0!r}&#x27;</span><span class="token plain">.format</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self.request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">))</span></div></code></pre></div><p class="css-1ccrm8j">In order to track the state of our tasks, it’s necessary to configure Celery’s <a href="https://docs.celeryproject.org/en/v4.0.1/userguide/configuration.html#result-backend" class="css-1bw77fa">result backend</a>. If we were setting this value via a config file, we would set a value for <code class="css-0">results_backend</code>, but since we’re setting it directly when initializing our Celery app, we can just set the value via a parameter named <code class="css-0">backend</code>. If you have already had some exposure to Celery, one design choice that may stand out to you is the use of RabbitMQ for Celery’s message broker but not for the results backend.</p><p class="css-1ccrm8j">I’ll approach this topic with both a short answer and a longer answer for those wishing for a lower-level explanation.</p><p class="css-1ccrm8j"><strong class="css-0">Short Answer:</strong> Due to how the celery-progress package works, asynchronous tasks will fail with RabbitMQ but will work with Redis.</p><p class="css-1ccrm8j"><strong class="css-0">Long Answer:</strong> Celery has both an <a href="https://en.wikipedia.org/wiki/Advanced_Message_Queuing_Protocol" class="css-1bw77fa">Advanced Message Queuing Protocol</a> (AMQP) and a <a href="https://en.wikipedia.org/wiki/Remote_procedure_call" class="css-1bw77fa">Remote Procedure Call</a> (RPC) backend. <a href="https://patrick.cloke.us/posts/2019/10/04/celery-amqp-backends/" class="css-1bw77fa">This blog post</a> provides a good explanation of the design in terms of the limitations of each backend with regards Celery. <a href="https://docs.celeryproject.org/en/stable/internals/reference/celery.backends.amqp.html" class="css-1bw77fa">Celery’s AMQP backend is now deprecated</a> though and its documentation advises the <a href="https://docs.celeryproject.org/en/stable/internals/reference/celery.backends.rpc.html" class="css-1bw77fa">RPC backend</a> for those wishing to use RabbitMQ for their results backend. The issue with the RPC backend is that, <a href="https://docs.celeryproject.org/en/latest/userguide/tasks.html#rpc-result-backend-rabbitmq-qpid" class="css-1bw77fa">in the words of Celery’s documentation</a>, “it doesn’t actually store the states, but rather sends them as messages. This is an important difference as it means that a result can <em class="css-0">only be retrieved once</em>, and <em class="css-0">only by the client that initiated the task</em>”. As a consequence, celery-progress fails to successfully pull all task states once the user adds multiple concurrent tasks.</p><p class="css-1ccrm8j">An alternative for our Celery backend, that will support concurrent tasks, is Redis. This combination is framed as a ‘popular choice’ in celery’s documentation as RabbitMQ is less prone to data loss. In terms of choosing a message broker, Celery’s documentation warns “Redis is also feature-complete, but is more susceptible to data loss in the event of abrupt termination or power failures.” Depending on your use-case, Redis or RabbitMQ alone could be a good fit. We’re going to use both for this scenario. The simplest way to provision Redis and RabbitMQ is via Docker. You can pull a <a href="https://hub.docker.com/_/redis/" class="css-1bw77fa">Redis image</a> and a <a href="https://hub.docker.com/_/rabbitmq" class="css-1bw77fa">RabbitMQ image</a> from Docker Hub and provision a docker container by running this single command in your terminal:</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-dybovu">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> run -d -p </span><span class="token number" style="color:rgb(247, 140, 108)">5672</span><span class="token plain">:5672 rabbitmq </span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">docker</span><span class="token plain"> run -d -p </span><span class="token number" style="color:rgb(247, 140, 108)">6379</span><span class="token plain">:6379 redis</span></div></code></pre></div><p class="css-1ccrm8j">Now that we’ve created our celery.py file, it’s necessary to update our project’s <em class="css-0">init</em> file (<code class="css-0">demo_project/__init__.py</code>) so that our celery app is imported when Django starts up. For those seeking a deeper insight, this Celery/Django configuration is based off the Celery tutorial <a href="https://docs.celeryproject.org/en/stable/django/first-steps-with-django.html" class="css-1bw77fa">First Steps With Django</a>.</p><div class="gatsby-highlight" data-language="python"><pre class="prism-code language-python" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-dybovu">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-python"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token keyword" style="color:rgb(127, 219, 202)">from</span><span class="token plain"> __future__ </span><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> absolute_import</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> unicode_literals</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic"># This will make sure the app is always imported when</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic"># Django starts so that shared_task will use this app.</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">from</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">celery </span><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> app </span><span class="token keyword" style="color:rgb(127, 219, 202)">as</span><span class="token plain"> celery_app</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">__all__ </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;celery_app&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></code></pre></div><p class="css-1ccrm8j">The final piece of the Celery setup is to create the function for our logic. Let’s create a file called tasks.py inside our Django app (ie. <code class="css-0">celery_demo/demo_project/demo_app/tasks.py</code>)</p><div class="gatsby-highlight" data-language="python"><pre class="prism-code language-python" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-dybovu">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-python"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token keyword" style="color:rgb(127, 219, 202)">from</span><span class="token plain"> celery </span><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> shared_task</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">from</span><span class="token plain"> celery_progress</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">backend </span><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> ProgressRecorder</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> datetime</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">from</span><span class="token plain"> nasapy </span><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> Nasa</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> random</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> time</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">nasa </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> Nasa</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">key</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token string" style="color:rgb(173, 219, 103)">&quot;Generate your API Key at https://api.nasa.gov/&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">@shared_task</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">bind</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">True</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">get_nasa_image</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> seconds</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token plain">    progress_recorder </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> ProgressRecorder</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token plain">    result </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">for</span><span class="token plain"> i </span><span class="token keyword" style="color:rgb(127, 219, 202)">in</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">range</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">seconds</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15</span><span class="token plain">        time</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">sleep</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">16</span><span class="token plain">        result </span><span class="token operator" style="color:rgb(127, 219, 202)">+=</span><span class="token plain"> i</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">17</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">18</span><span class="token plain">        start_date </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> datetime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">datetime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">strptime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;06/16/1995&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;%m/%d/%Y&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">19</span><span class="token plain">        end_date </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> datetime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">datetime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">now</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">20</span><span class="token plain">        time_between_dates </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> end_date </span><span class="token operator" style="color:rgb(127, 219, 202)">-</span><span class="token plain"> start_date</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">21</span><span class="token plain">        days_between_dates </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> time_between_dates</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">days</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">22</span><span class="token plain">        image_not_suitable </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">True</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">23</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">24</span><span class="token plain">        </span><span class="token keyword" style="color:rgb(127, 219, 202)">while</span><span class="token plain"> image_not_suitable</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">25</span><span class="token plain">            random_number_of_days </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> random</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">randrange</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">days_between_dates</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">26</span><span class="token plain">            random_date </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> start_date </span><span class="token operator" style="color:rgb(127, 219, 202)">+</span><span class="token plain"> datetime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">timedelta</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">days</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">random_number_of_days</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">27</span><span class="token plain">            nasa_image_result </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> nasa</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">picture_of_the_day</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">random_date</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">28</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">29</span><span class="token plain">            </span><span class="token keyword" style="color:rgb(127, 219, 202)">if</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;url&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">in</span><span class="token plain"> nasa_image_result </span><span class="token keyword" style="color:rgb(127, 219, 202)">and</span><span class="token plain"> nasa_image_result</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;url&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">endswith</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;.bmp&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;.gif&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;.heif&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;.jpeg&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;.jpg&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;.png&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;.svg&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;.webp&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">30</span><span class="token plain">                </span><span class="token keyword" style="color:rgb(127, 219, 202)">break</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">31</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">32</span><span class="token plain">        progress_recorder</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">set_progress</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">i </span><span class="token operator" style="color:rgb(127, 219, 202)">+</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> seconds</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> description</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">nasa_image_result</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">33</span><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">return</span><span class="token plain"> result</span></div></code></pre></div><p class="css-1ccrm8j">Our task could potentially have done any manner of work. It seemed more fun though to do something more interesting than, say, counting to 100. Our task will be retrieving random images from NASA’s <em class="css-0">Astronomy Picture of the Day API</em>. See <a href="http://api.nasa.gov/" class="css-1bw77fa">api.nasa.gov</a> for further info and to generate your own API key. As the API sometimes links to YouTube videos and interactive web pages, it makes sense from a visual perspective for us to only link image files. The task itself is relatively straightforward. Iterate through a numerical range and for each iteration do the following:</p><ol class="css-15rlv7r"><li class="css-0">Generate a random date within a valid date range</li><li class="css-0">Retrieve an image for this date</li><li class="css-0">Check if the image is valid and repeat steps 3 + 4 if necessary, until a valid image file is retrieved</li><li class="css-0">Update Celery’s progress with an image URL and metadata</li></ol><p class="css-1ccrm8j">One cool feature of note is that metadata is being passed back in JSON format. With Celery configured and our celery task written, we can now build out the Django frontend. The first step is integrating celery-progress; a Python package that manages the polling of celery’s results backend and visualizes it with progress bars. Celery polls Redis every 500 milliseconds, updating the progress bars on if necessary.</p><p class="css-1ccrm8j">First off, let’s update our projects urls file (<code class="css-0">demo_project/demo_project/urls.py</code>) with the following:</p><div class="gatsby-highlight" data-language="python"><pre class="prism-code language-python" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-dybovu">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-python"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token keyword" style="color:rgb(127, 219, 202)">from</span><span class="token plain"> django</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">contrib </span><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> admin</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">from</span><span class="token plain"> django</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">urls </span><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> include</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> re_path</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain">urlpatterns </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain">    re_path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">r&#x27;^&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> include</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;demo_app.urls&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">    re_path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">r&#x27;^celery-progress/&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> include</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;celery_progress.urls&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span></div></code></pre></div><p class="css-1ccrm8j">In our project’s <em class="css-0">settings</em> file (<code class="css-0">celery_demo/demo_project/demo_project/settings.py</code>), we need to add <em class="css-0">demo<!-- -->_<!-- -->app</em>, <em class="css-0">celery</em>, and <em class="css-0">celery<!-- -->_<!-- -->progress</em> to the INSTALLED_APPS variable in our settings.py file</p><div class="gatsby-highlight" data-language="python"><pre class="prism-code language-python" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-dybovu">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-python"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">INSTALLED_APPS </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain">    </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;django.contrib.admin&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">    </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;django.contrib.auth&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain">    </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;django.contrib.contenttypes&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain">    </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;django.contrib.sessions&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">    </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;django.contrib.messages&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">    </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;django.contrib.staticfiles&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">    </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;demo_app&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">    </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;celery&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain">    </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;celery_progress&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span></div></code></pre></div><p class="css-1ccrm8j">We also need to update our project’s <em class="css-0">views</em> file (ie. <code class="css-0">celery_demo/demo_project/demo_app/views.py</code>)</p><p class="css-1ccrm8j">Here we are adding a new view which will call our Celery task eight times. Each individual Celery task will then poll NASA&#x27;s API five times. In order for us to track the progress of each task on the frontend, it is necessary to return the id of each Celery tasks. I have chosen to go with a dictionary data structure as it allows us to iterate easily through multiple concurrent task ids. The logic iterates from 0 to 7, creating a dictionary which maps each number in the range to its corresponding Celery task.</p><div class="gatsby-highlight" data-language="python"><pre class="prism-code language-python" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-dybovu">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-python"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token keyword" style="color:rgb(127, 219, 202)">from</span><span class="token plain"> django</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">contrib </span><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> admin</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">from</span><span class="token plain"> django</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">urls </span><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> include</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> re_path</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain">urlpatterns </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain">    re_path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">r&#x27;^&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> include</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;demo_app.urls&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">    re_path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">r&#x27;^celery-progress/&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> include</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;celery_progress.urls&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span></div></code></pre></div><h3 id="frontend-logic-and-templates" class="css-1o6lusp">Frontend Logic and Templates</h3><p class="css-1ccrm8j">Within our Django app, create a file named urls.py (ie. <code class="css-0">celery_demo/demo_project/demo_app/urls.py</code>). The purpose of this is to map a template file to the URL path. In our case it’s our webapp’s root directory (ie. What is displayed at <a href="http://127.0.0.1:8000/" class="css-1bw77fa">http://127.0.0.1:8000/</a>).</p><div class="gatsby-highlight" data-language="python"><pre class="prism-code language-python" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-dybovu">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-python"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token keyword" style="color:rgb(127, 219, 202)">from</span><span class="token plain"> django</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">contrib </span><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> admin</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">from</span><span class="token plain"> django</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">urls </span><span class="token keyword" style="color:rgb(127, 219, 202)">import</span><span class="token plain"> include</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> re_path</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain">urlpatterns </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain">    re_path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">r&#x27;^&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> include</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;demo_app.urls&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">    re_path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">r&#x27;^celery-progress/&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> include</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;celery_progress.urls&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span></div></code></pre></div><p class="css-1ccrm8j">The next logical step is to create our template file. Within the Django app’s <em class="css-0">templates</em> folder, create another folder named <em class="css-0">demo<!-- -->_<!-- -->app</em> and a file named <em class="css-0">index.html</em> within it. (ie. <code class="css-0">celery_demo/demo_project/demo_app/templates/demo_app/index.html</code>). The level of nesting in this file path may seem excessive but the namespacing is an important discipline that would become apparent if this Django project had another app containing a template named index.html. From the <a href="https://docs.djangoproject.com/en/3.0/intro/tutorial03/" class="css-1bw77fa">Django documentation</a>: <em class="css-0">&quot;Django will choose the first template it finds whose name matches, and if you had a template with the same name in a different application, Django would be unable to distinguish between them.&quot;</em></p><p class="css-1ccrm8j">Our template will be somewhat involved, so now is a good time to check and ensure that everything is working as expected. Let’s write the text ‘Hello World’ to this template file and confirm that everything is working ok by checking our webapp in the browser. Run <code class="css-0">python3 manage.py runserver</code> in your terminal and you should see something like this in your browser at <a href="http://127.0.0.1:8000/" class="css-1bw77fa">http://127.0.0.1:8000/</a>.</p><p class="css-1ccrm8j"><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:960px">
      <span class="gatsby-resp-image-background-image" style="padding-bottom:62.5%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAZUlEQVQoz+2LQQqAIBQFvf9BIhEr9X8jPUO06QxBi7aBkhrVpl1RW4eBx1sMmeZldaEfxqKsKJMSzCEahRbQgrZ4CtoCGl5DI1qpOsoE40C8dynF9AlyTQhxe0W4H5J+kOMcP8Y7nSL4cwbVjhkAAAAASUVORK5CYII=&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image css-0" alt="Django Hello World" title="Django Hello World" src="/static/f7bb0d5a8d58e82ea36df9a5776ef361/7d769/django_hello_world.png" srcSet="/static/f7bb0d5a8d58e82ea36df9a5776ef361/5243c/django_hello_world.png 240w,/static/f7bb0d5a8d58e82ea36df9a5776ef361/ab158/django_hello_world.png 480w,/static/f7bb0d5a8d58e82ea36df9a5776ef361/7d769/django_hello_world.png 960w,/static/f7bb0d5a8d58e82ea36df9a5776ef361/4af54/django_hello_world.png 1400w" sizes="(max-width: 960px) 100vw, 960px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
    </span></p><p class="css-1ccrm8j">Now let’s fill out our index.html template properly.</p><div class="gatsby-highlight" data-language="html"><pre class="prism-code language-html" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-dybovu">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-html"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token doctype punctuation" style="color:rgb(199, 146, 234);font-style:italic">&lt;!</span><span class="token doctype doctype-tag" style="color:rgb(199, 146, 234);font-style:italic">DOCTYPE</span><span class="token doctype" style="color:rgb(199, 146, 234);font-style:italic"> </span><span class="token doctype name" style="color:rgb(199, 146, 234);font-style:italic">html</span><span class="token doctype punctuation" style="color:rgb(199, 146, 234);font-style:italic">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">2</span><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">html</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">lang</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">en</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">3</span><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">head</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">4</span><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">title</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">Celery-Progress Example</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">title</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">5</span><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">meta</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">charset</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">utf-8</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">6</span><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">meta</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">name</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">viewport</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">content</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">width=device-width, initial-scale=1</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">7</span><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">link</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">rel</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">stylesheet</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">href</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">8</span><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">script</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">src</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">script</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">9</span><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">script</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">src</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">script</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">10</span><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">script</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">src</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">script</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">11</span><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">style</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token style language-css"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">12</span><span class="token style language-css">            </span><span class="token style language-css selector class" style="color:rgb(199, 146, 234);font-style:italic">.nasa-image</span><span class="token style language-css"> </span><span class="token style language-css punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token style language-css"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">13</span><span class="token style language-css">                </span><span class="token style language-css property" style="color:rgb(128, 203, 196)">max-width</span><span class="token style language-css punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token style language-css"> </span><span class="token style language-css number" style="color:rgb(247, 140, 108)">100</span><span class="token style language-css unit">%</span><span class="token style language-css punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token style language-css"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">14</span><span class="token style language-css">                </span><span class="token style language-css property" style="color:rgb(128, 203, 196)">max-height</span><span class="token style language-css punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token style language-css"> </span><span class="token style language-css number" style="color:rgb(247, 140, 108)">230</span><span class="token style language-css unit">px</span><span class="token style language-css punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token style language-css"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">15</span><span class="token style language-css">                </span><span class="token style language-css property" style="color:rgb(128, 203, 196)">padding-bottom</span><span class="token style language-css punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token style language-css"> </span><span class="token style language-css number" style="color:rgb(247, 140, 108)">5</span><span class="token style language-css unit">px</span><span class="token style language-css punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token style language-css"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">16</span><span class="token style language-css">            </span><span class="token style language-css punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token style language-css"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">17</span><span class="token style language-css">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">style</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">18</span><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">head</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">19</span><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">body</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">20</span><span class="token plain">        {% load static %}</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">21</span><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">class</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">bg-dark text-white text-center</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">22</span><span class="token plain">            </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">h1</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">Celery-Progress Demo</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">h1</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">23</span><span class="token plain">            </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">p</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">Utilising NASA&#x27;s </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">i</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">Astonomy Image of the Day</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">i</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"> API</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">p</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"> </span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">24</span><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">25</span><span class="token plain">        </span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">26</span><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">class</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">container-fluid</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">27</span><span class="token plain">            </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">class</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">row align-items-end</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">28</span><span class="token plain">                {% for key in celery_task_ids %}</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">29</span><span class="token plain">                    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">class</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">col-sm-3</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">30</span><span class="token plain">                        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">class</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">text-center</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">31</span><span class="token plain">                            </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">img</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">id</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">progress-bar{{ key }}-image</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">src</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">class</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">nasa-image</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">32</span><span class="token plain">                        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">33</span><span class="token plain">                        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">a</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">id</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">progress-bar{{ key }}-image-link</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">href</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">a</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">34</span><span class="token plain">                        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">class</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&#x27;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">progress-wrapper</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&#x27;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">35</span><span class="token plain">                            </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">id</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">progress-bar{{ key }}</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">class</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&#x27;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">progress-bar</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&#x27;</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag special-attr attr-name" style="color:rgb(173, 219, 103);font-style:italic">style</span><span class="token tag special-attr attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag special-attr attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag special-attr attr-value value css language-css property" style="color:rgb(128, 203, 196)">background-color</span><span class="token tag special-attr attr-value value css language-css punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token tag special-attr attr-value value css language-css" style="color:rgb(127, 219, 202)"> </span><span class="token tag special-attr attr-value value css language-css hexcode color" style="color:rgb(127, 219, 202)">#68a9ef</span><span class="token tag special-attr attr-value value css language-css punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token tag special-attr attr-value value css language-css" style="color:rgb(127, 219, 202)"> </span><span class="token tag special-attr attr-value value css language-css property" style="color:rgb(128, 203, 196)">width</span><span class="token tag special-attr attr-value value css language-css punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token tag special-attr attr-value value css language-css" style="color:rgb(127, 219, 202)"> </span><span class="token tag special-attr attr-value value css language-css number" style="color:rgb(247, 140, 108)">0</span><span class="token tag special-attr attr-value value css language-css unit" style="color:rgb(127, 219, 202)">%</span><span class="token tag special-attr attr-value value css language-css punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token tag special-attr attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token entity named-entity">&amp;nbsp;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">36</span><span class="token plain">                        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">37</span><span class="token plain">                        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">id</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">progress-bar{{ key }}-message</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">Waiting for progress to start...</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">38</span><span class="token plain">                    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">39</span><span class="token plain">                {% endfor %}</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">40</span><span class="token plain">            </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">41</span><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">div</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">42</span><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">body</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">43</span><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">html</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">44</span><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">&lt;!-- celery logic --&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">45</span><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">script</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">src</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">{% static </span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&#x27;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">celery_progress/celery_progress.js</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&#x27;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)"> %}</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">script</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">46</span><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">script</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">47</span><span class="token script language-javascript">    </span><span class="token script language-javascript keyword" style="color:rgb(127, 219, 202)">function</span><span class="token script language-javascript"> </span><span class="token script language-javascript function" style="color:rgb(130, 170, 255)">customProgress</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token script language-javascript parameter">progressBarElement</span><span class="token script language-javascript parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token script language-javascript parameter"> progressBarMessageElement</span><span class="token script language-javascript parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token script language-javascript parameter"> progress</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">48</span><span class="token script language-javascript">        barIdentifier </span><span class="token script language-javascript operator" style="color:rgb(127, 219, 202)">=</span><span class="token script language-javascript"> progressBarElement</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token script language-javascript property-access">id</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token script language-javascript method function property-access" style="color:rgb(130, 170, 255)">substring</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token script language-javascript number" style="color:rgb(247, 140, 108)">12</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">49</span><span class="token script language-javascript">        </span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">50</span><span class="token script language-javascript">        </span><span class="token script language-javascript keyword control-flow" style="color:rgb(127, 219, 202)">if</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token script language-javascript">progress</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token script language-javascript property-access">current</span><span class="token script language-javascript"> </span><span class="token script language-javascript operator" style="color:rgb(127, 219, 202)">==</span><span class="token script language-javascript"> </span><span class="token script language-javascript number" style="color:rgb(247, 140, 108)">0</span><span class="token script language-javascript"> </span><span class="token script language-javascript operator" style="color:rgb(127, 219, 202)">&amp;&amp;</span><span class="token script language-javascript"> progress</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token script language-javascript property-access">total</span><span class="token script language-javascript"> </span><span class="token script language-javascript operator" style="color:rgb(127, 219, 202)">==</span><span class="token script language-javascript"> </span><span class="token script language-javascript number" style="color:rgb(247, 140, 108)">100</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">51</span><span class="token script language-javascript">            progressMessage </span><span class="token script language-javascript operator" style="color:rgb(127, 219, 202)">=</span><span class="token script language-javascript"> </span><span class="token script language-javascript string" style="color:rgb(173, 219, 103)">&quot;&quot;</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">52</span><span class="token script language-javascript">        </span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token script language-javascript"> </span><span class="token script language-javascript keyword control-flow" style="color:rgb(127, 219, 202)">else</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">53</span><span class="token script language-javascript">            </span><span class="token script language-javascript keyword control-flow" style="color:rgb(127, 219, 202)">if</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token script language-javascript">progress</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token script language-javascript property-access">description</span><span class="token script language-javascript"> </span><span class="token script language-javascript operator" style="color:rgb(127, 219, 202)">&amp;&amp;</span><span class="token script language-javascript"> progress</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token script language-javascript property-access">description</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token script language-javascript property-access">url</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">54</span><span class="token script language-javascript">                </span><span class="token script language-javascript keyword" style="color:rgb(127, 219, 202)">var</span><span class="token script language-javascript"> nasaImageElement </span><span class="token script language-javascript operator" style="color:rgb(127, 219, 202)">=</span><span class="token script language-javascript"> </span><span class="token script language-javascript dom variable" style="color:rgb(214, 222, 235)">document</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token script language-javascript method function property-access" style="color:rgb(130, 170, 255)">getElementById</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token script language-javascript">progressBarElement</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token script language-javascript property-access">id</span><span class="token script language-javascript"> </span><span class="token script language-javascript operator" style="color:rgb(127, 219, 202)">+</span><span class="token script language-javascript"> </span><span class="token script language-javascript string" style="color:rgb(173, 219, 103)">&quot;-image&quot;</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">55</span><span class="token script language-javascript">                nasaImageElement</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token script language-javascript property-access">src</span><span class="token script language-javascript"> </span><span class="token script language-javascript operator" style="color:rgb(127, 219, 202)">=</span><span class="token script language-javascript"> progress</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token script language-javascript property-access">description</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token script language-javascript property-access">url</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">56</span><span class="token script language-javascript">                </span><span class="token script language-javascript keyword" style="color:rgb(127, 219, 202)">var</span><span class="token script language-javascript"> nasaImageLinkElement </span><span class="token script language-javascript operator" style="color:rgb(127, 219, 202)">=</span><span class="token script language-javascript"> </span><span class="token script language-javascript dom variable" style="color:rgb(214, 222, 235)">document</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token script language-javascript method function property-access" style="color:rgb(130, 170, 255)">getElementById</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token script language-javascript">progressBarElement</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token script language-javascript property-access">id</span><span class="token script language-javascript"> </span><span class="token script language-javascript operator" style="color:rgb(127, 219, 202)">+</span><span class="token script language-javascript"> </span><span class="token script language-javascript string" style="color:rgb(173, 219, 103)">&quot;-image-link&quot;</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">57</span><span class="token script language-javascript">                nasaImageLinkElement</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token script language-javascript property-access">href</span><span class="token script language-javascript"> </span><span class="token script language-javascript operator" style="color:rgb(127, 219, 202)">=</span><span class="token script language-javascript"> progress</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token script language-javascript property-access">description</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token script language-javascript property-access">url</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">58</span><span class="token script language-javascript">                nasaImageLinkElement</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token script language-javascript property-access">innerHTML</span><span class="token script language-javascript"> </span><span class="token script language-javascript operator" style="color:rgb(127, 219, 202)">=</span><span class="token script language-javascript"> progress</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token script language-javascript property-access">description</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token script language-javascript property-access">date</span><span class="token script language-javascript"> </span><span class="token script language-javascript operator" style="color:rgb(127, 219, 202)">+</span><span class="token script language-javascript"> </span><span class="token script language-javascript string" style="color:rgb(173, 219, 103)">&quot; | &quot;</span><span class="token script language-javascript"> </span><span class="token script language-javascript operator" style="color:rgb(127, 219, 202)">+</span><span class="token script language-javascript"> progress</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token script language-javascript property-access">description</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token script language-javascript property-access">title</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">59</span><span class="token script language-javascript">            </span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">60</span><span class="token script language-javascript" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">61</span><span class="token script language-javascript">            taskNumber </span><span class="token script language-javascript operator" style="color:rgb(127, 219, 202)">=</span><span class="token script language-javascript"> </span><span class="token script language-javascript function" style="color:rgb(130, 170, 255)">parseInt</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token script language-javascript">progress</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token script language-javascript property-access">current</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token script language-javascript operator" style="color:rgb(127, 219, 202)">+</span><span class="token script language-javascript number" style="color:rgb(247, 140, 108)">1</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">62</span><span class="token script language-javascript">            taskPercentage </span><span class="token script language-javascript operator" style="color:rgb(127, 219, 202)">=</span><span class="token script language-javascript"> taskNumber </span><span class="token script language-javascript operator" style="color:rgb(127, 219, 202)">/</span><span class="token script language-javascript"> progress</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token script language-javascript property-access">total</span><span class="token script language-javascript"> </span><span class="token script language-javascript operator" style="color:rgb(127, 219, 202)">*</span><span class="token script language-javascript"> </span><span class="token script language-javascript number" style="color:rgb(247, 140, 108)">100</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">63</span><span class="token script language-javascript" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">64</span><span class="token script language-javascript">            progressBarElement</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token script language-javascript property-access">style</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token script language-javascript property-access">backgroundColor</span><span class="token script language-javascript"> </span><span class="token script language-javascript operator" style="color:rgb(127, 219, 202)">=</span><span class="token script language-javascript"> </span><span class="token script language-javascript string" style="color:rgb(173, 219, 103)">&quot;#68a9ef&quot;</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">65</span><span class="token script language-javascript">            progressBarElement</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token script language-javascript property-access">style</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token script language-javascript property-access">width</span><span class="token script language-javascript"> </span><span class="token script language-javascript operator" style="color:rgb(127, 219, 202)">=</span><span class="token script language-javascript"> taskPercentage </span><span class="token script language-javascript operator" style="color:rgb(127, 219, 202)">+</span><span class="token script language-javascript"> </span><span class="token script language-javascript string" style="color:rgb(173, 219, 103)">&quot;%&quot;</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">66</span><span class="token script language-javascript">            progressBarMessageElement</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token script language-javascript property-access">className</span><span class="token script language-javascript"> </span><span class="token script language-javascript operator" style="color:rgb(127, 219, 202)">=</span><span class="token script language-javascript"> </span><span class="token script language-javascript string" style="color:rgb(173, 219, 103)">&quot;alert alert-info&quot;</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">67</span><span class="token script language-javascript">            progressMessage </span><span class="token script language-javascript operator" style="color:rgb(127, 219, 202)">=</span><span class="token script language-javascript"> </span><span class="token script language-javascript string" style="color:rgb(173, 219, 103)">&quot;Currently fetching image &quot;</span><span class="token script language-javascript"> </span><span class="token script language-javascript operator" style="color:rgb(127, 219, 202)">+</span><span class="token script language-javascript"> taskNumber </span><span class="token script language-javascript operator" style="color:rgb(127, 219, 202)">+</span><span class="token script language-javascript"> </span><span class="token script language-javascript string" style="color:rgb(173, 219, 103)">&quot; of &quot;</span><span class="token script language-javascript"> </span><span class="token script language-javascript operator" style="color:rgb(127, 219, 202)">+</span><span class="token script language-javascript"> progress</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token script language-javascript property-access">total</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">68</span><span class="token script language-javascript">        </span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">69</span><span class="token script language-javascript" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">70</span><span class="token script language-javascript">        progressBarMessageElement</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token script language-javascript property-access">innerHTML</span><span class="token script language-javascript"> </span><span class="token script language-javascript operator" style="color:rgb(127, 219, 202)">=</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">71</span><span class="token script language-javascript">            progressMessage</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">72</span><span class="token script language-javascript">        </span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">73</span><span class="token script language-javascript">    </span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">74</span><span class="token script language-javascript"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">script</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">75</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">76</span><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">script</span><span class="token tag" style="color:rgb(127, 219, 202)"> </span><span class="token tag attr-name" style="color:rgb(173, 219, 103);font-style:italic">src</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(199, 146, 234)">=</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">{% static </span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&#x27;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)">celery_progress/celery_progress.js</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&#x27;</span><span class="token tag attr-value" style="color:rgb(127, 219, 202)"> %}</span><span class="token tag attr-value punctuation" style="color:rgb(199, 146, 234)">&quot;</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">script</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">77</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">78</span><span class="token plain">{% for key, value in celery_task_ids.items %}</span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">79</span><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(127, 219, 202)">script</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">80</span><span class="token script language-javascript">        </span><span class="token script language-javascript dom variable" style="color:rgb(214, 222, 235)">document</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token script language-javascript method function property-access" style="color:rgb(130, 170, 255)">addEventListener</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token script language-javascript string" style="color:rgb(173, 219, 103)">&quot;DOMContentLoaded&quot;</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token script language-javascript"> </span><span class="token script language-javascript keyword" style="color:rgb(127, 219, 202)">function</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">81</span><span class="token script language-javascript">            </span><span class="token script language-javascript keyword" style="color:rgb(127, 219, 202)">var</span><span class="token script language-javascript"> progressUrl </span><span class="token script language-javascript operator" style="color:rgb(127, 219, 202)">=</span><span class="token script language-javascript"> </span><span class="token script language-javascript string" style="color:rgb(173, 219, 103)">&quot;{% url &#x27;celery_progress:task_status&#x27; value %}&quot;</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">82</span><span class="token script language-javascript">            </span><span class="token script language-javascript maybe-class-name">CeleryProgressBar</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token script language-javascript method function property-access" style="color:rgb(130, 170, 255)">initProgressBar</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token script language-javascript">progressUrl</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">83</span><span class="token script language-javascript">                </span><span class="token script language-javascript literal-property property" style="color:rgb(128, 203, 196)">onProgress</span><span class="token script language-javascript operator" style="color:rgb(127, 219, 202)">:</span><span class="token script language-javascript"> customProgress</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">84</span><span class="token script language-javascript">                </span><span class="token script language-javascript literal-property property" style="color:rgb(128, 203, 196)">progressBarId</span><span class="token script language-javascript operator" style="color:rgb(127, 219, 202)">:</span><span class="token script language-javascript"> </span><span class="token script language-javascript string" style="color:rgb(173, 219, 103)">&quot;progress-bar{{ key }}&quot;</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">85</span><span class="token script language-javascript">                </span><span class="token script language-javascript literal-property property" style="color:rgb(128, 203, 196)">progressBarMessageId</span><span class="token script language-javascript operator" style="color:rgb(127, 219, 202)">:</span><span class="token script language-javascript"> </span><span class="token script language-javascript string" style="color:rgb(173, 219, 103)">&quot;progress-bar{{ key }}-message&quot;</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">86</span><span class="token script language-javascript">            </span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">87</span><span class="token script language-javascript">        </span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token script language-javascript punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token script language-javascript"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">88</span><span class="token script language-javascript">    </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(127, 219, 202)">script</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#d6deeb"><span class="line-number-style">89</span><span class="token plain">{% endfor %}</span></div></code></pre></div><p class="css-1ccrm8j">There are a three main parts to this template: CSS for styling everything , Python logic written in Django’s <a href="https://docs.djangoproject.com/en/3.0/ref/templates/language/" class="css-1bw77fa">template language</a>, and JavaScript logic for integrating celery-progress and dynamically updating relevant HTML elements.</p><ul class="css-15rlv7r"><li class="css-0">In the head of the file the dependencies for the Bootstrap CSS framework are imported. A custom CSS class selector is necessary in addition to Bootstrap’s default stylesheets. The purpose of this class selector is to ensure that all eight images are uniform in height and width, regardless of the dimensions of the source images.</li><li class="css-0">The code for generating the visual content that the user will see is all nested within one <a href="https://www.w3schools.com/bootstrap4/bootstrap_containers.asp" class="css-1bw77fa">Bootstrap container</a>. Our view file has already passed a Python dictionary named <em class="css-0">celery<!-- -->_<!-- -->task<!-- -->_<!-- -->ids</em> to this template. The code iterates through this dictionary and dynamically generates the raw HTML that displays the images.</li><li class="css-0">Most of the JavaScript that the celery-progress package requires is already configured by default. We require two additions. The first is to add event listeners so that celery-progress begins polling Redis for task-state updates as soon as the DOM loads. It is also necessary to override the default onProgress function which celery-progress calls each time a task’s state updates. It is necessary to override this as the HTML used to display our images differs from the celery-progress default; we are updating each element with an image and each image’s metadata.</li></ul><h3 id="running-final-app" class="css-1o6lusp">Running Final App</h3><p class="css-1ccrm8j">With our template complete, we are now ready to view the finished product. First let’s start up Celery:</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-dybovu">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">python3 -m celery -A demo_project worker -l info --concurrency</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token number" style="color:rgb(247, 140, 108)">8</span></div></code></pre></div><p class="css-1ccrm8j">Where this command is run from is important. It should be run from within this project root folder (ie. <code class="css-0">celery_demo/</code>). Note that a <em class="css-0">concurrency</em> flag is included and set to eight. Celery defaults this value to the host machine’s number of cores, so if I was to run this on a four-core machine without the concurrency flag set, it would only run four concurrent tasks at a time.</p><p class="css-1ccrm8j">Finally, if it isn’t already running, start the Django webserver:</p><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="color:#d6deeb;background-color:#011627" data-linenumber="true"><button type="button" name="copy code to clipboard" class="code-copy-button css-dybovu">Copy<span aria-roledescription="status" class="css-15vf505">copy code to clipboard</span></button><code class="language-bash"><div class="token-line" style="color:#d6deeb"><span class="line-number-style">1</span><span class="token plain">python3 manage.py runserver</span></div></code></pre></div><p class="css-1ccrm8j">Navigate to <a href="http://127.0.0.1:8000/" class="css-1bw77fa">http://127.0.0.1:8000/</a> in your web browser and enjoy 40 unique images from Nasa’s Astronomy Picture of the Day. For reference, <a href="https://www.youtube.com/watch?v=dWAJru1xx34" class="css-1bw77fa">here’s a screen-recording of the web app in action</a>, and if your web app failed to work as expected, you can of course clone the original from <a href="https://github.com/oisinBates/celery_progress_demo" class="css-1bw77fa">GitHub</a>.</p></section></main><style data-emotion="css y7pay1">.css-y7pay1{box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;margin-top:8rem;color:var(--theme-ui-colors-secondary);-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;border-top-style:solid;border-top-width:1px;border-top-color:var(--theme-ui-colors-divide);padding-top:1rem;}.css-y7pay1 a{color:var(--theme-ui-colors-secondary);-webkit-text-decoration:none;text-decoration:none;}.css-y7pay1 a:hover{color:var(--theme-ui-colors-heading);-webkit-text-decoration:underline;text-decoration:underline;}.css-y7pay1 a:focus{color:var(--theme-ui-colors-heading);}@media screen and (min-width: 640px){.css-y7pay1{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}}@media screen and (min-width: 768px){.css-y7pay1{-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}}</style><footer class="css-y7pay1"><div>© <!-- -->2023<!-- --> by <!-- -->Oisín Bates<!-- -->. All rights reserved.</div><div><a aria-label="Link to the theme&#x27;s GitHub repository" href="https://github.com/LekoArts/gatsby-themes/tree/main/themes/gatsby-theme-minimal-blog" class="css-1fmmdck">Theme</a> <!-- -->by<!-- --> <a aria-label="Link to the theme author&#x27;s website" href="https://www.lekoarts.de?utm_source=minimal-blog&amp;utm_medium=Theme" class="css-1fmmdck">LekoArts</a></div></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/dynamic-filtering-with-vuejs-and-rmarkdown";window.___webpackCompilationHash="f09e34ba86eb9e743073";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-4dbba807cf0e1020619d.js"],"app":["/app-ac1b9c0f96449b4d6250.js"],"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-blog-query-tsx":["/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-blog-query-tsx-1a6583e1189fdf54d906.js"],"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-homepage-query-tsx":["/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-homepage-query-tsx-67219bab65337bfbfda6.js"],"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-page-query-tsx":["/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-page-query-tsx-adc4c4bbc7792adfc8eb.js"],"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx":["/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-41c213e6e3bc75b18d85.js"],"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-tag-query-tsx":["/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-tag-query-tsx-edceff93287f235ee7fa.js"],"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-tags-query-tsx":["/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-tags-query-tsx-7d59e47afb12621e8c16.js"],"component---src-pages-404-jsx":["/component---src-pages-404-jsx-8b45ad208afeb2164090.js"]};/*]]>*/</script><script src="/polyfill-4dbba807cf0e1020619d.js" nomodule=""></script><script src="/app-ac1b9c0f96449b4d6250.js" async=""></script><script src="/framework-b93e9b3b15354a4a47e0.js" async=""></script><script src="/webpack-runtime-93f6110cd843c7220410.js" async=""></script></body></html>